__author__ = 'dankle'

import argparse
import Pyro4
import os

ap = argparse.ArgumentParser()
ap.add_argument('-k', help="HMAC key file to use", action="store", required=False, default="~/.hmac.key")
ap.add_argument('-n', help="host name", action="store", required=False, default="localhost")
ap.add_argument('-p', help="port", action="store", required=False, default=9090)

opts = ap.parse_args()

hmac_key = ""
if opts.k:
    f = open(os.path.expanduser(opts.k))
    hmac_key = f.read().strip()
    f.close()

try:
    (nameserverUri, nameserverDaemon, broadcastServer) = Pyro4.naming.startNSloop(host=opts.n, port=int(opts.p), hmac=hmac_key)
except :
    print "NameServer did not start. If it's already running, this is normal."